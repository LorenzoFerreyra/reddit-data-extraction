---
title: "Trabajo de Taller de Investigación: Text mining"
author: "Lorenzo Ferreyra"
format: html
editor: visual
---

## Librerías

Importamos las librerías necesarias.

```{r}
#| echo: false
library(readxl)
library(dplyr)
library(stringr)
library(tidytext)
library(ggplot2)
library(knitr)
```

## Carga de datos

Se leen los archivos de Excel. En el paso anterior de transformación, se dividió el archivo .json extraído de Reddit en dos entidades: comentarios y publicaciones, para mantener una estructura relacional y que los comentarios no pierdan los metadatos de las publicaciones asociadas.

```{r}
comments <- read_excel("output_files/comments.xlsx")
posts <- read_excel("output_files/posts.xlsx")
```

Se obtiene un vistazo preliminar de los primeros registros de los conjuntos de datos para verificar que la lectura del archivo fue exitosa y entender la estructura de las variables antes de iniciar el análisis como tal.

Estructura de comentarios.

```{r}
head(comments, 5) %>% 
  kable()
```

Estructura de publicaciones

```{r}
head(posts, 5) %>% 
  kable()
```

## Preprocesamiento de datos

Se limpia el texto de los comentarios; se pasa todo a minúsculas, se eliminan links, símbolos irrelevantes, etc.

```{r}
comments_clean <- comments %>%
  mutate(body = str_to_lower(body)) %>%
  mutate(body = str_remove_all(body, "http\\S+|www\\S+")) %>%
  mutate(body = str_remove_all(body, "[^a-záéíóúüñ\\s]")) %>%
  mutate(body = str_squish(body))
```

The `echo: false` option disables the printing of code (only output is displayed).

```{r}
comments_clean
```
